<!-- YL Guest Registration (no secret) -->
<div id="yl-guest-form" style="font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial, sans-serif;">
  <form id="guestForm" style="max-width:560px;margin:20px auto;padding:20px;border-radius:14px;background:#083b55;color:#fff;box-shadow:0 12px 28px rgba(0,0,0,.18)">
    <h2 style="margin:0 0 12px;font-weight:800;">Guest Registration</h2>
    <p style="margin:0 0 16px;opacity:.9;">Enter your table number (e.g., <strong>Table#07</strong> or just <strong>7</strong>).</p>

    <label>Table#<br>
      <input required name="tableNumber" id="tableNumber" type="text" placeholder="Table#07 or 7" style="width:100%;padding:12px;border-radius:10px;border:0;margin:6px 0 12px;">
    </label>

    <label>First name<br>
      <input required name="firstName" type="text" autocomplete="given-name" style="width:100%;padding:12px;border-radius:10px;border:0;margin:6px 0 12px;">
    </label>
    <label>Last name<br>
      <input required name="lastName" type="text" autocomplete="family-name" style="width:100%;padding:12px;border-radius:10px;border:0;margin:6px 0 12px;">
    </label>
    <label>Email<br>
      <input required name="email" type="email" autocomplete="email" style="width:100%;padding:12px;border-radius:10px;border:0;margin:6px 0 18px;">
    </label>

    <button type="submit" style="background:#f8b735;color:#083b55;font-weight:800;border:0;border-radius:999px;padding:12px 18px;cursor:pointer;">Register</button>
    <span id="guestStatus" style="margin-left:12px;"></span>
  </form>
</div>

<script>
(function(){
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbxb7PzfjkwwVT8E3aEpxMSVot3wNxPqQFk3n-4OVwz9oAASlNtrWR7DXx4ybs5y_FE_lA/exec'; // <-- paste the /exec URL
  const MIN_TABLE = 1, MAX_TABLE = 30;

  function post(payload) {
    return fetch(ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
      body: 'payload=' + encodeURIComponent(JSON.stringify(payload))
    }).then(r => r.json());
  }

  // Optional: prefill from ?t=Table#07
  const params = new URLSearchParams(location.search);
  const t = params.get('t');
  if (t) document.getElementById('tableNumber').value = t;

  function normalize(input) {
    const s = String(input).trim().toLowerCase().replace(/\s+/g,'');
    const m = s.match(/(\d{1,2})$/);
    if (!m) return null;
    const num = parseInt(m[1], 10);
    if (num < MIN_TABLE || num > MAX_TABLE) return null;
    return `Table#${String(num).padStart(2,'0')}`;
  }

  document.getElementById('guestForm').addEventListener('submit', async (ev) => {
    ev.preventDefault();
    const f = new FormData(ev.target);

    const normalized = normalize(f.get('tableNumber'));
    const status = document.getElementById('guestStatus');

    if (!normalized) {
      status.textContent = `Enter a valid table between ${MIN_TABLE} and ${MAX_TABLE}.`;
      return;
    }

    const payload = {
      action: 'registerGuest',
      tableNumber: normalized,
      firstName: f.get('firstName').trim(),
      lastName:  f.get('lastName').trim(),
      email:     f.get('email').trim()
    };

    status.textContent = 'Submittingâ€¦';
    try {
      const res = await post(payload);
      if (!res.ok) throw new Error(res.error || 'Unknown error');
      status.textContent = `Success! Registered for ${res.table}.`;
      ev.target.reset();
      document.getElementById('tableNumber').value = normalized; // keep table prefilled
    } catch (e) {
      status.textContent = 'Error: ' + e.message;
    }
  });
})();
</script>